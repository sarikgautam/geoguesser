<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeoGuessr Clone</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet" />

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .mapboxgl-popup-content {
            padding: 10px;
            border-radius: 8px;
        }

        .street-view-container {
            background: linear-gradient(45deg, #4f46e5, #7c3aed);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Street View component using Mapbox Static Images API
        function StreetView({ location }) {
            const [imageUrl, setImageUrl] = useState('');
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                if (location) {
                    setLoading(true);
                    // Generate a random bearing for variety
                    const bearing = Math.floor(Math.random() * 360);
                    const pitch = Math.floor(Math.random() * 20) - 10; // -10 to 10 degrees

                    // Use Mapbox Static Images API to get street-level imagery
                    const url = `https://api.mapbox.com/styles/v1/mapbox/streets-v11/static/${location.lng},${location.lat},16,${bearing},${pitch}/800x600@2x?access_token=${MAPBOX_TOKEN}`;

                    setImageUrl(url);
                    setLoading(false);
                }
            }, [location]);

            if (!location || loading) {
                return (
                    <div className="street-view-container h-full">
                        <div className="text-center">
                            <div className="text-6xl mb-4">üìç</div>
                            <h2 className="text-2xl font-bold mb-2">Loading Location...</h2>
                        </div>
                    </div>
                );
            }

            return (
                <div className="h-full w-full relative overflow-hidden">
                    <img
                        src={imageUrl}
                        alt="Street view"
                        className="w-full h-full object-cover"
                        onError={() => {
                            // Fallback to satellite view if street view fails
                            const fallbackUrl = `https://api.mapbox.com/styles/v1/mapbox/satellite-streets-v11/static/${location.lng},${location.lat},17/800x600@2x?access_token=${MAPBOX_TOKEN}`;
                            setImageUrl(fallbackUrl);
                        }}
                    />
                    <div className="absolute bottom-4 left-4 bg-black bg-opacity-50 text-white px-3 py-2 rounded-lg text-sm">
                        üìç Mystery Location
                    </div>
                </div>
            );
        }

        // Sample locations for different regions (Street View verified)
        const LOCATIONS = {
            world: [
                // Europe
                { lat: 48.8584, lng: 2.2945, name: "Eiffel Tower, Paris" },
                { lat: 51.5007, lng: -0.1246, name: "Big Ben, London" },
                { lat: 52.5163, lng: 13.3777, name: "Brandenburg Gate, Berlin" },
                { lat: 41.8902, lng: 12.4922, name: "Colosseum, Rome" },
                { lat: 40.4168, lng: -3.7038, name: "Puerta del Sol, Madrid" },
                { lat: 59.3293, lng: 18.0686, name: "Gamla Stan, Stockholm" },
                { lat: 50.0755, lng: 14.4378, name: "Old Town Square, Prague" },
                { lat: 47.4979, lng: 19.0402, name: "Parliament, Budapest" },
                { lat: 38.7071, lng: -9.1359, name: "Rossio Square, Lisbon" },
                { lat: 55.6761, lng: 12.5683, name: "Nyhavn, Copenhagen" },
                { lat: 52.3676, lng: 4.9041, name: "Dam Square, Amsterdam" },
                { lat: 46.9480, lng: 7.4474, name: "Old Town, Bern" },
                { lat: 47.0379, lng: 15.4237, name: "Hauptplatz, Graz" },
                { lat: 60.1699, lng: 24.9384, name: "Senate Square, Helsinki" },
                { lat: 59.9139, lng: 10.7522, name: "Karl Johans Gate, Oslo" },
                { lat: 49.4521, lng: 11.0767, name: "Nuremberg, Germany" },
                { lat: 50.9375, lng: 6.9603, name: "Cologne, Germany" },
                { lat: 53.5511, lng: 9.9937, name: "Hamburg, Germany" },
                { lat: 48.7758, lng: 9.1829, name: "Stuttgart, Germany" },
                { lat: 51.0504, lng: 13.7373, name: "Dresden, Germany" },

                // Asia
                { lat: 35.6586, lng: 139.7454, name: "Shibuya Crossing, Tokyo" },
                { lat: 39.9042, lng: 116.4074, name: "Forbidden City, Beijing" },
                { lat: 1.2966, lng: 103.8764, name: "Marina Bay, Singapore" },
                { lat: 22.3193, lng: 114.1694, name: "Victoria Harbour, Hong Kong" },
                { lat: 37.5665, lng: 126.9780, name: "Gangnam District, Seoul" },
                { lat: 28.6139, lng: 77.2090, name: "India Gate, New Delhi" },
                { lat: 19.0760, lng: 72.8777, name: "Gateway of India, Mumbai" },
                { lat: 13.7563, lng: 100.5018, name: "Grand Palace, Bangkok" },
                { lat: 21.0285, lng: 105.8542, name: "Hoan Kiem Lake, Hanoi" },
                { lat: 10.8231, lng: 106.6297, name: "Notre Dame Cathedral, Ho Chi Minh City" },
                { lat: 3.1390, lng: 101.6869, name: "Petronas Towers, Kuala Lumpur" },
                { lat: -6.2088, lng: 106.8456, name: "National Monument, Jakarta" },
                { lat: 14.5995, lng: 120.9842, name: "Rizal Park, Manila" },
                { lat: 25.2048, lng: 55.2708, name: "Burj Khalifa, Dubai" },
                { lat: 31.2304, lng: 121.4737, name: "The Bund, Shanghai" },
                { lat: 27.7172, lng: 85.3240, name: "Kathmandu, Nepal" },
                { lat: 28.2096, lng: 83.9856, name: "Pokhara, Nepal" },
                { lat: 27.6844, lng: 85.3446, name: "Bhaktapur, Nepal" },
                { lat: 26.4838, lng: 87.2832, name: "Biratnagar, Nepal" },
                { lat: 27.5330, lng: 84.5000, name: "Chitwan, Nepal" },
                { lat: 28.6129, lng: 77.2295, name: "India Gate, New Delhi" },
  { lat: 28.5245, lng: 77.1855, name: "Qutub Minar, Delhi" },
  { lat: 27.1751, lng: 78.0421, name: "Taj Mahal, Agra" },
  { lat: 27.4975, lng: 77.6720, name: "Prem Mandir, Vrindavan" },
  { lat: 26.9124, lng: 75.7873, name: "Hawa Mahal, Jaipur" },
  { lat: 25.1972, lng: 75.8648, name: "Bundi Stepwell, Rajasthan" },
  { lat: 26.3051, lng: 73.0151, name: "Mehrangarh Fort, Jodhpur" },
  { lat: 24.5854, lng: 73.7125, name: "Lake Pichola, Udaipur" },
  { lat: 28.0034, lng: 79.4204, name: "Rampur, Uttar Pradesh" },

  // Uttarakhand & Himachal
  { lat: 30.0668, lng: 79.0193, name: "Rudraprayag, Uttarakhand" },
  { lat: 30.0668, lng: 78.2916, name: "Rishikesh, Ganga Ghats" },
  { lat: 30.3792, lng: 78.4741, name: "Mussoorie, Mall Road" },
  { lat: 32.2396, lng: 77.1887, name: "Manali, Himachal Pradesh" },
  { lat: 32.7266, lng: 76.9480, name: "Keylong, Himachal Pradesh" },
  { lat: 31.6330, lng: 74.8723, name: "Golden Temple, Amritsar" },

  // Central India
  { lat: 23.2599, lng: 77.4126, name: "Bhopal, Madhya Pradesh" },
  { lat: 24.5854, lng: 73.7125, name: "Chittorgarh Fort" },
  { lat: 21.1944, lng: 81.3509, name: "Raipur, Chhattisgarh" },
  { lat: 23.8315, lng: 91.2820, name: "Ujjayanta Palace, Tripura" },

  // Eastern India
  { lat: 22.5726, lng: 88.3639, name: "Howrah Bridge, Kolkata" },
  { lat: 26.1445, lng: 91.7362, name: "Guwahati, Assam" },
  { lat: 25.6106, lng: 85.1414, name: "Patna, Bihar" },
  { lat: 21.2787, lng: 81.8661, name: "Bilaspur, Chhattisgarh" },
  { lat: 23.6102, lng: 85.2799, name: "Ranchi, Jharkhand" },
  { lat: 27.4905, lng: 94.9120, name: "Ziro Valley, Arunachal Pradesh" },

  // Western India
  { lat: 18.5204, lng: 73.8567, name: "Pune, Maharashtra" },
  { lat: 19.0760, lng: 72.8777, name: "Gateway of India, Mumbai" },
  { lat: 22.3072, lng: 73.1812, name: "Vadodara, Gujarat" },
  { lat: 23.0225, lng: 72.5714, name: "Ahmedabad, Gujarat" },
  { lat: 21.1702, lng: 72.8311, name: "Surat, Gujarat" },
  { lat: 20.0110, lng: 73.7903, name: "Nashik, Maharashtra" },
  { lat: 15.2993, lng: 74.1240, name: "Old Goa Church Complex" },

  // South India
  { lat: 13.0827, lng: 80.2707, name: "Chennai Marina Beach" },
  { lat: 12.9716, lng: 77.5946, name: "Bangalore, Karnataka" },
  { lat: 9.9312, lng: 76.2673, name: "Fort Kochi, Kerala" },
  { lat: 8.5241, lng: 76.9366, name: "Trivandrum, Kerala" },
  { lat: 17.3850, lng: 78.4867, name: "Charminar, Hyderabad" },
  { lat: 11.0168, lng: 76.9558, name: "Coimbatore, Tamil Nadu" },
  { lat: 12.2958, lng: 76.6394, name: "Mysore Palace, Karnataka" },

  // Islands and Unique Places
  { lat: 10.2155, lng: 92.6385, name: "Cellular Jail, Andaman Islands" },
  { lat: 9.9312, lng: 72.8459, name: "Minicoy Island, Lakshadweep" },
  { lat: 33.7782, lng: 76.5762, name: "Leh City, Ladakh" },
  { lat: 34.0837, lng: 74.7973, name: "Dal Lake, Srinagar" },
  { lat: 31.1048, lng: 77.1734, name: "Shimla Mall Road, Himachal" },

                // Americas
                { lat: 40.7589, lng: -73.9851, name: "Times Square, New York" },
                { lat: 34.1341, lng: -118.3215, name: "Hollywood Blvd, Los Angeles" },
                { lat: -22.9519, lng: -43.2105, name: "Christ the Redeemer, Rio" },
                { lat: 19.4326, lng: -99.1332, name: "Z√≥calo, Mexico City" },
                { lat: -34.6037, lng: -58.3816, name: "Plaza de Mayo, Buenos Aires" },
                { lat: -33.4489, lng: -70.6693, name: "Plaza de Armas, Santiago" },
                { lat: 4.7110, lng: -74.0721, name: "Plaza Bol√≠var, Bogot√°" },
                { lat: -12.0464, lng: -77.0428, name: "Plaza de Armas, Lima" },
                { lat: 45.5017, lng: -73.5673, name: "Old Montreal, Montreal" },
                { lat: 49.2827, lng: -123.1207, name: "Stanley Park, Vancouver" },
                { lat: 43.6532, lng: -79.3832, name: "CN Tower, Toronto" },
                { lat: 46.8139, lng: -71.2082, name: "Quebec City, Canada" },
                { lat: 43.651070, lng: -79.347015, name: "Toronto, Canada" },
                { lat: 45.5017, lng: -73.5673, name: "Montreal, Canada" },
                { lat: 53.5461, lng: -113.4938, name: "Edmonton, Canada" },
                { lat: 49.2827, lng: -123.1207, name: "Vancouver, Canada" },
                { lat: 36.1699, lng: -115.1398, name: "Las Vegas, USA" },
                { lat: 30.2672, lng: -97.7431, name: "Austin, Texas, USA" },
                { lat: 44.9778, lng: -93.2650, name: "Minneapolis, USA" },
                { lat: 35.0844, lng: -106.6504, name: "Albuquerque, USA" },
                { lat: 33.4484, lng: -112.0740, name: "Phoenix, Arizona, USA" },


                // Africa & Middle East
                { lat: -26.2041, lng: 28.0473, name: "Johannesburg CBD" },
                { lat: -33.9249, lng: 18.4241, name: "Table Mountain, Cape Town" },
                { lat: 30.0444, lng: 31.2357, name: "Tahrir Square, Cairo" },
                { lat: 33.8869, lng: 9.5375, name: "Medina, Tunis" },
                { lat: 33.5731, lng: -7.5898, name: "Hassan II Mosque, Casablanca" },
                { lat: 36.8065, lng: 10.1815, name: "Medina, Tunis" },
                { lat: 31.7683, lng: 35.2137, name: "Old City, Jerusalem" },
                { lat: 33.8938, lng: 35.5018, name: "Martyrs' Square, Beirut" },
                { lat: 41.0082, lng: 28.9784, name: "Sultanahmet, Istanbul" },

                // Oceania
                { lat: -33.8568, lng: 151.2153, name: "Sydney Opera House" },
                { lat: -37.8136, lng: 144.9631, name: "Federation Square, Melbourne" },
                { lat: -27.4698, lng: 153.0251, name: "South Bank, Brisbane" },
                { lat: -31.9505, lng: 115.8605, name: "Kings Park, Perth" },
                { lat: -41.2865, lng: 174.7762, name: "Te Papa, Wellington" },
                { lat: -36.8485, lng: 174.7633, name: "Sky Tower, Auckland" },
                { lat: -28.0167, lng: 153.4000, name: "Gold Coast, Australia" },
                { lat: -23.6980, lng: 133.8807, name: "Alice Springs, Australia" },
                { lat: -31.9535, lng: 115.8575, name: "Perth, Australia" },
                { lat: -35.2809, lng: 149.1300, name: "Canberra, Australia" },
                { lat: -37.8140, lng: 144.9633, name: "Melbourne, Australia" },
                { lat: 6.9271, lng: 79.8612, name: "Galle Face Green, Colombo, Sri Lanka" },
                { lat: 13.7563, lng: 100.5018, name: "Chinatown, Bangkok, Thailand" },
                { lat: 10.8231, lng: 106.6297, name: "Ben Thanh Market, Ho Chi Minh City, Vietnam" },
                { lat: 21.0285, lng: 105.8542, name: "Old Quarter, Hanoi, Vietnam" },
                { lat: 39.9042, lng: 116.4074, name: "Forbidden City, Beijing, China" },
                { lat: 25.2048, lng: 55.2708, name: "Old Souk, Dubai, UAE" },
                { lat: 33.5138, lng: 36.2765, name: "Omayyad Mosque, Damascus, Syria" },
                // üåç Africa
                { lat: -1.2921, lng: 36.8219, name: "Nairobi National Park Entrance, Kenya" },
                { lat: -17.8578, lng: 31.0292, name: "Harare Gardens, Zimbabwe" },
                { lat: 9.0579, lng: 38.7613, name: "Meskel Square, Addis Ababa, Ethiopia" },
                { lat: 31.6340, lng: -7.9999, name: "Jemaa el-Fnaa Square, Marrakech, Morocco" },
                { lat: -4.0435, lng: 39.6682, name: "Old Town, Mombasa, Kenya" },
                // üåç South America
                { lat: -34.6037, lng: -58.3816, name: "La Boca Neighborhood, Buenos Aires, Argentina" },
                { lat: -13.5319, lng: -71.9675, name: "San Pedro Market, Cusco, Peru" },
                { lat: -16.5000, lng: -68.1500, name: "Witches' Market, La Paz, Bolivia" },
                { lat: -12.0432, lng: -77.0282, name: "Miraflores District, Lima, Peru" },
                { lat: -22.9068, lng: -43.1729, name: "Lapa Arches, Rio de Janeiro, Brazil" },

                // üåç Central America & Caribbean
                { lat: 18.4663, lng: -66.1057, name: "Old San Juan, Puerto Rico" },
                { lat: 14.6349, lng: -90.5069, name: "Historic Center, Guatemala City" },
                { lat: 13.7000, lng: -89.2000, name: "Plaza Barrios, San Salvador" },
                { lat: 9.9333, lng: -84.0833, name: "Mercado Central, San Jos√©, Costa Rica" },

                // üåç Eastern Europe & Balkans
                { lat: 42.6975, lng: 23.3242, name: "Alexander Nevsky Cathedral, Sofia, Bulgaria" },
                { lat: 44.7866, lng: 20.4489, name: "Skadarlija Street, Belgrade, Serbia" },
                { lat: 41.9981, lng: 21.4254, name: "Old Bazaar, Skopje, North Macedonia" },
                { lat: 42.4304, lng: 19.2594, name: "Shkod√´r Promenade, Albania" },
                { lat: 43.8563, lng: 18.4131, name: "Ba≈°ƒçar≈°ija, Sarajevo, Bosnia & Herzegovina" },

                // üåç Miscellaneous
                { lat: -0.1807, lng: -78.4678, name: "Centro Hist√≥rico, Quito, Ecuador" },
                { lat: 36.2021, lng: 37.1343, name: "Citadel of Aleppo, Syria" },
                { lat: 47.3769, lng: 8.5417, name: "Limmatquai Street, Zurich, Switzerland" },
                { lat: 55.6761, lng: 12.5683, name: "Nyhavn, Copenhagen, Denmark" },
                { lat: 35.8997, lng: 14.5146, name: "Mdina Old City, Malta" },
                { lat: 27.7172, lng: 85.3240, name: "Kathmandu Durbar Square" },
                { lat: 27.6710, lng: 85.4298, name: "Patan Durbar Square, Lalitpur" },
                { lat: 27.6736, lng: 85.4270, name: "Mahabouddha Temple, Patan" },
                { lat: 27.6715, lng: 85.4322, name: "Kumbheshwar Temple, Lalitpur" },
                { lat: 27.6717, lng: 85.3206, name: "Thamel, Kathmandu" },
                { lat: 27.6763, lng: 85.4281, name: "Patan Museum" },
                { lat: 27.6844, lng: 85.4286, name: "Bhaktapur Durbar Square" },
                { lat: 27.6672, lng: 85.4276, name: "Kirtipur Old Town" },
                { lat: 27.7333, lng: 85.2996, name: "Swayambhunath (Monkey Temple)" },

                // Pokhara Region
                { lat: 28.2096, lng: 83.9856, name: "Lakeside, Pokhara" },
                { lat: 28.2419, lng: 83.9739, name: "World Peace Pagoda, Pokhara" },
                { lat: 28.2155, lng: 83.9684, name: "Devi's Fall, Pokhara" },
                { lat: 28.2639, lng: 83.9727, name: "Phewa Lake" },
                { lat: 28.2611, lng: 83.9680, name: "Gupteshwor Mahadev Cave" },
                { lat: 28.2657, lng: 83.9811, name: "Mahendra Cave, Pokhara" },

                // Terai Cities
                { lat: 27.0126, lng: 84.8808, name: "Birgunj, Parsa" },
                { lat: 26.4838, lng: 87.2832, name: "Biratnagar, Morang" },
                { lat: 27.5382, lng: 83.4880, name: "Bharatpur, Chitwan" },
                { lat: 26.6785, lng: 87.1423, name: "Dharan, Sunsari" },
                { lat: 26.6433, lng: 87.1235, name: "Itahari, Sunsari" },
                { lat: 27.0930, lng: 84.8920, name: "Hetauda, Makwanpur" },
                { lat: 26.6820, lng: 88.0782, name: "Birtamod, Jhapa" },
                { lat: 26.8034, lng: 85.5593, name: "Janakpur Dham, Dhanusha" },
                { lat: 27.5866, lng: 83.6033, name: "Butwal, Rupandehi" },
                { lat: 27.4838, lng: 83.4377, name: "Lumbini, Birthplace of Buddha" },
                { lat: 26.6537, lng: 85.2023, name: "Gaur, Rautahat" },

                // Hilly Towns
                { lat: 27.8810, lng: 84.4103, name: "Gorkha Durbar, Gorkha" },
                { lat: 29.8402, lng: 80.5952, name: "Darchula Bazaar, Far West" },
                { lat: 27.6085, lng: 85.2772, name: "Banepa, Kavre" },
                { lat: 27.7245, lng: 85.2802, name: "Dhulikhel, Kavre" },
                { lat: 28.0325, lng: 84.1263, name: "Bandipur, Tanahun" },
                { lat: 28.1035, lng: 84.0190, name: "Damauli, Tanahun" },
                { lat: 27.9383, lng: 84.3860, name: "Syangja Bazaar" },
                { lat: 29.3315, lng: 82.1801, name: "Simikot, Humla (remote)" },
                { lat: 29.0704, lng: 81.5735, name: "Jumla Bazaar" },

                // Mid & Far Western
                { lat: 28.7081, lng: 80.5884, name: "Dhangadhi, Kailali" },
                { lat: 28.9879, lng: 80.1792, name: "Tikapur, Kailali" },
                { lat: 28.3795, lng: 81.4213, name: "Gulariya, Bardiya" },
                { lat: 27.9239, lng: 81.6296, name: "Nepalgunj, Banke" },
                { lat: 28.1996, lng: 81.7377, name: "Tulsipur, Dang" },
                { lat: 28.6288, lng: 81.3081, name: "Lamahi, Dang" },
                { lat: 28.6131, lng: 81.0485, name: "Ghorahi, Dang" }
            ],
            usa: [
                // Major Cities
                { lat: 40.7589, lng: -73.9851, name: "Times Square, NYC" },
                { lat: 34.1341, lng: -118.3215, name: "Hollywood Blvd, LA" },
                { lat: 41.8781, lng: -87.6298, name: "Millennium Park, Chicago" },
                { lat: 29.7604, lng: -95.3698, name: "Downtown Houston" },
                { lat: 33.4484, lng: -112.0740, name: "Downtown Phoenix" },
                { lat: 39.9496, lng: -75.1503, name: "Independence Hall, Philadelphia" },
                { lat: 29.4241, lng: -98.4936, name: "River Walk, San Antonio" },
                { lat: 32.7767, lng: -96.7970, name: "Dealey Plaza, Dallas" },
                { lat: 37.8199, lng: -122.4783, name: "Golden Gate Bridge, SF" },
                { lat: 47.6205, lng: -122.3493, name: "Pike Place Market, Seattle" },

                // More Cities
                { lat: 25.7617, lng: -80.1918, name: "South Beach, Miami" },
                { lat: 36.1627, lng: -86.7816, name: "Music Row, Nashville" },
                { lat: 30.2672, lng: -97.7431, name: "State Capitol, Austin" },
                { lat: 39.7392, lng: -104.9903, name: "Union Station, Denver" },
                { lat: 45.5152, lng: -122.6784, name: "Pioneer Courthouse Square, Portland" },
                { lat: 44.9778, lng: -93.2650, name: "Mill City Museum, Minneapolis" },
                { lat: 42.3601, lng: -71.0589, name: "Boston Common, Boston" },
                { lat: 38.9072, lng: -77.0369, name: "National Mall, Washington DC" },
                { lat: 33.7490, lng: -84.3880, name: "Centennial Olympic Park, Atlanta" },
                { lat: 39.2904, lng: -76.6122, name: "Inner Harbor, Baltimore" },
                { lat: 41.4993, lng: -81.6944, name: "Public Square, Cleveland" },
                { lat: 42.3314, lng: -83.0458, name: "Hart Plaza, Detroit" },
                { lat: 38.6270, lng: -90.1994, name: "Gateway Arch, St. Louis" },
                { lat: 35.2271, lng: -80.8431, name: "Uptown, Charlotte" },
                { lat: 35.7796, lng: -78.6382, name: "State Capitol, Raleigh" },
                { lat: 26.1224, lng: -80.1373, name: "Las Olas Boulevard, Fort Lauderdale" },
                { lat: 27.9506, lng: -82.4572, name: "Bayshore Boulevard, Tampa" },
                { lat: 32.0835, lng: -81.0998, name: "Historic District, Savannah" },
                { lat: 29.9511, lng: -90.0715, name: "French Quarter, New Orleans" },
                { lat: 36.1540, lng: -95.9928, name: "Brady Arts District, Tulsa" },
                { lat: 35.4676, lng: -97.5164, name: "Bricktown, Oklahoma City" }
            ],
            europe: [
                // Western Europe
                { lat: 48.8584, lng: 2.2945, name: "Eiffel Tower, Paris" },
                { lat: 51.5007, lng: -0.1246, name: "Big Ben, London" },
                { lat: 52.5163, lng: 13.3777, name: "Brandenburg Gate, Berlin" },
                { lat: 41.8902, lng: 12.4922, name: "Colosseum, Rome" },
                { lat: 40.4168, lng: -3.7038, name: "Puerta del Sol, Madrid" },
                { lat: 52.3676, lng: 4.9041, name: "Dam Square, Amsterdam" },
                { lat: 50.8503, lng: 4.3517, name: "Grand Place, Brussels" },
                { lat: 46.9480, lng: 7.4474, name: "Old Town, Bern" },
                { lat: 47.0379, lng: 15.4237, name: "Hauptplatz, Graz" },
                { lat: 48.2082, lng: 16.3738, name: "Stephansplatz, Vienna" },
                { lat: 50.0755, lng: 14.4378, name: "Old Town Square, Prague" },
                { lat: 47.4979, lng: 19.0402, name: "Parliament, Budapest" },
                { lat: 38.7071, lng: -9.1359, name: "Rossio Square, Lisbon" },
                { lat: 41.3851, lng: 2.1734, name: "Sagrada Familia, Barcelona" },
                { lat: 45.4642, lng: 9.1900, name: "Duomo, Milan" },
                { lat: 43.7696, lng: 11.2558, name: "Piazza del Duomo, Florence" },
                { lat: 40.8518, lng: 14.2681, name: "Piazza del Plebiscito, Naples" },
                { lat: 51.0486, lng: 13.7373, name: "Frauenkirche, Dresden" },
                { lat: 53.5511, lng: 9.9937, name: "Speicherstadt, Hamburg" },
                { lat: 48.1351, lng: 11.5820, name: "Marienplatz, Munich" },

                // Northern Europe
                { lat: 59.3293, lng: 18.0686, name: "Gamla Stan, Stockholm" },
                { lat: 55.6761, lng: 12.5683, name: "Nyhavn, Copenhagen" },
                { lat: 60.1699, lng: 24.9384, name: "Senate Square, Helsinki" },
                { lat: 59.9139, lng: 10.7522, name: "Karl Johans Gate, Oslo" },
                { lat: 64.1466, lng: -21.9426, name: "Hallgr√≠mskirkja, Reykjavik" },
                { lat: 53.3498, lng: -6.2603, name: "Temple Bar, Dublin" },
                { lat: 55.9533, lng: -3.1883, name: "Royal Mile, Edinburgh" },
                { lat: 51.4816, lng: -3.1791, name: "Cardiff Castle, Cardiff" },

                // Eastern Europe
                { lat: 55.7539, lng: 37.6208, name: "Red Square, Moscow" },
                { lat: 59.9311, lng: 30.3609, name: "Palace Square, St. Petersburg" },
                { lat: 52.2297, lng: 21.0122, name: "Old Town, Warsaw" },
                { lat: 50.0647, lng: 19.9450, name: "Main Market Square, Krakow" },
                { lat: 44.4268, lng: 26.1025, name: "Old Town, Bucharest" },
                { lat: 42.6977, lng: 23.3219, name: "Alexander Nevsky Cathedral, Sofia" },
                { lat: 45.8150, lng: 15.9819, name: "Ban Jelaƒçiƒá Square, Zagreb" },
                { lat: 46.0569, lng: 14.5058, name: "Pre≈°eren Square, Ljubljana" },
                { lat: 48.1486, lng: 17.1077, name: "Old Town, Bratislava" },
                { lat: 50.4501, lng: 30.5234, name: "Independence Square, Kiev" },
                // üåç Europe
                { lat: 59.9139, lng: 10.7522, name: "Aker Brygge, Oslo, Norway" },
                { lat: 64.1265, lng: -21.8174, name: "Hallgr√≠mskirkja Church, Reykjavik, Iceland" },
                { lat: 47.4979, lng: 19.0402, name: "Fisherman's Bastion, Budapest, Hungary" },
                { lat: 54.6872, lng: 25.2797, name: "Old Town, Vilnius, Lithuania" },
                { lat: 56.9496, lng: 24.1052, name: "Freedom Monument, Riga, Latvia" },
                { lat: 52.2297, lng: 21.0122, name: "≈Åazienki Park, Warsaw, Poland" }
            ]
        };

        const MAPBOX_TOKEN = 'pk.eyJ1Ijoic2FyaWtnYXV0YW0iLCJhIjoiY2s0NW5nY3VrMGJhbjNtcGk1ZjVjc290byJ9.SsMxIG3adgCn5Zak24IKFg';

        function GeoGuessrGame() {
            const [gameState, setGameState] = useState('menu'); // menu, playing, results
            const [currentRound, setCurrentRound] = useState(1);
            const [totalRounds] = useState(10);
            const [score, setScore] = useState(0);
            const [roundScores, setRoundScores] = useState([]);
            const [currentLocation, setCurrentLocation] = useState(null);
            const [guessedLocation, setGuessedLocation] = useState(null);
            const [mapMode, setMapMode] = useState('world');
            const [showResult, setShowResult] = useState(false);
            const [distance, setDistance] = useState(0);
            const mapContainer = useRef(null);
            const map = useRef(null);

            // Calculate distance between two points using Haversine formula
            const calculateDistance = (lat1, lng1, lat2, lng2) => {
                const R = 6371; // Earth's radius in kilometers
                const dLat = (lat2 - lat1) * Math.PI / 180;
                const dLng = (lng2 - lng1) * Math.PI / 180;
                const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                    Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                    Math.sin(dLng / 2) * Math.sin(dLng / 2);
                const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
                return R * c;
            };

            // Calculate score based on distance (max 5000 points)
            const calculateScore = (distance) => {
                if (distance === 0) return 5000;
                return Math.max(0, Math.round(5000 * Math.exp(-distance / 2000)));
            };

            // Initialize map
            useEffect(() => {
                if (gameState === 'playing' && mapContainer.current && !map.current) {

                    mapboxgl.accessToken = MAPBOX_TOKEN;

                    map.current = new mapboxgl.Map({
                        container: mapContainer.current,
                        style: 'mapbox://styles/mapbox/streets-v11',
                        center: [0, 20],
                        zoom: 1.5
                    });

                    map.current.on('click', (e) => {
                        if (!showResult) {
                            const { lng, lat } = e.lngLat;
                            setGuessedLocation({ lat, lng });

                            // Add guess marker
                            new mapboxgl.Marker({ color: 'red' })
                                .setLngLat([lng, lat])
                                .addTo(map.current);
                        }
                    });
                }
            }, [gameState, showResult]);

            // Start new game
            const startGame = (mode) => {
                setMapMode(mode);
                setGameState('playing');
                setCurrentRound(1);
                setScore(0);
                setRoundScores([]);
                startNewRound(mode);
            };

            // Start new round
            const startNewRound = (mode = mapMode) => {
                const locations = LOCATIONS[mode] || LOCATIONS.world;
                const randomLocation = locations[Math.floor(Math.random() * locations.length)];
                setCurrentLocation(randomLocation);
                setGuessedLocation(null);
                setShowResult(false);
                setDistance(0);

                // Clear map markers
                if (map.current) {
                    const markers = document.querySelectorAll('.mapboxgl-marker');
                    markers.forEach(marker => marker.remove());
                }
            };

            // Submit guess
            const submitGuess = () => {
                if (!guessedLocation || !currentLocation) return;

                const dist = calculateDistance(
                    currentLocation.lat, currentLocation.lng,
                    guessedLocation.lat, guessedLocation.lng
                );

                const roundScore = calculateScore(dist);
                setDistance(dist);
                setScore(prev => prev + roundScore);
                setRoundScores(prev => [...prev, roundScore]);
                setShowResult(true);

                // Add correct location marker
                if (map.current) {
                    new mapboxgl.Marker({ color: 'green' })
                        .setLngLat([currentLocation.lng, currentLocation.lat])
                        .setPopup(new mapboxgl.Popup().setHTML(`<strong>${currentLocation.name}</strong>`))
                        .addTo(map.current);

                    // Draw line between guess and correct location
                    map.current.addSource('route', {
                        'type': 'geojson',
                        'data': {
                            'type': 'Feature',
                            'properties': {},
                            'geometry': {
                                'type': 'LineString',
                                'coordinates': [
                                    [guessedLocation.lng, guessedLocation.lat],
                                    [currentLocation.lng, currentLocation.lat]
                                ]
                            }
                        }
                    });

                    map.current.addLayer({
                        'id': 'route',
                        'type': 'line',
                        'source': 'route',
                        'layout': {
                            'line-join': 'round',
                            'line-cap': 'round'
                        },
                        'paint': {
                            'line-color': '#ff6b6b',
                            'line-width': 3,
                            'line-dasharray': [2, 2]
                        }
                    });
                }
            };

            // Next round
            const nextRound = () => {
                if (currentRound < totalRounds) {
                    setCurrentRound(prev => prev + 1);

                    // Remove route layer
                    if (map.current && map.current.getLayer('route')) {
                        map.current.removeLayer('route');
                        map.current.removeSource('route');
                    }

                    startNewRound();
                } else {
                    setGameState('results');
                }
            };

            // Reset game
            const resetGame = () => {
                setGameState('menu');
                if (map.current) {
                    map.current.remove();
                    map.current = null;
                }
            };

            // Menu Screen
            if (gameState === 'menu') {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-600 to-purple-700 flex items-center justify-center p-4">
                        <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center">
                            <h1 className="text-4xl font-bold text-gray-800 mb-2">GeoGuessr</h1>
                            <p className="text-gray-600 mb-8">Test your geography knowledge!</p>

                            <div className="space-y-4">
                                <button
                                    onClick={() => startGame('world')}
                                    className="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200"
                                >
                                    üåç World Mode
                                </button>
                                <button
                                    onClick={() => startGame('usa')}
                                    className="w-full bg-red-600 hover:bg-red-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200"
                                >
                                    üá∫üá∏ USA Mode
                                </button>
                                <button
                                    onClick={() => startGame('europe')}
                                    className="w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200"
                                >
                                    üá™üá∫ Europe Mode
                                </button>
                            </div>

                            <div className="mt-8 text-sm text-gray-500">
                                <p>‚Ä¢ 10 rounds per game</p>
                                <p>‚Ä¢ Click on the map to guess</p>
                                <p>‚Ä¢ Closer guesses = higher scores</p>
                            </div>
                        </div>
                    </div>
                );
            }

            // Results Screen
            if (gameState === 'results') {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-green-600 to-blue-700 flex items-center justify-center p-4">
                        <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center">
                            <h1 className="text-3xl font-bold text-gray-800 mb-4">Game Complete!</h1>

                            <div className="bg-gradient-to-r from-yellow-400 to-orange-500 text-white rounded-lg p-6 mb-6">
                                <h2 className="text-2xl font-bold">Final Score</h2>
                                <p className="text-4xl font-bold">{score.toLocaleString()}</p>
                                <p className="text-sm opacity-90">out of 25,000 points</p>
                            </div>

                            <div className="space-y-2 mb-6">
                                <h3 className="font-semibold text-gray-700">Round Breakdown:</h3>
                                {roundScores.map((roundScore, index) => (
                                    <div key={index} className="flex justify-between items-center bg-gray-100 rounded px-3 py-2">
                                        <span>Round {index + 1}</span>
                                        <span className="font-semibold">{roundScore.toLocaleString()}</span>
                                    </div>
                                ))}
                            </div>

                            <button
                                onClick={resetGame}
                                className="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200"
                            >
                                Play Again
                            </button>
                        </div>
                    </div>
                );
            }

            // Game Screen
            return (
                <div className="h-screen flex flex-col bg-gray-100">
                    {/* Header */}
                    <div className="bg-white shadow-md p-4 flex justify-between items-center">
                        <div className="flex items-center space-x-4">
                            <h1 className="text-2xl font-bold text-gray-800">GeoGuessr</h1>
                            <span className="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-semibold">
                                {mapMode.toUpperCase()}
                            </span>
                        </div>

                        <div className="flex items-center space-x-6">
                            <div className="text-center">
                                <p className="text-sm text-gray-600">Round</p>
                                <p className="text-xl font-bold">{currentRound}/{totalRounds}</p>
                            </div>
                            <div className="text-center">
                                <p className="text-sm text-gray-600">Score</p>
                                <p className="text-xl font-bold text-green-600">{score.toLocaleString()}</p>
                            </div>
                        </div>
                    </div>

                    {/* Main Game Area */}
                    <div className="flex-1 flex">
                        {/* Street View */}
                        <div className="w-1/2 relative">
                            <StreetView location={currentLocation} />
                        </div>

                        {/* Map */}
                        <div className="w-1/2 relative">
                            <div ref={mapContainer} className="h-full" />

                            {/* Map Instructions */}
                            {!guessedLocation && !showResult && (
                                <div className="absolute top-4 left-4 bg-white bg-opacity-90 rounded-lg p-3 shadow-lg">
                                    <p className="text-sm font-semibold text-gray-700">
                                        Click on the map to make your guess!
                                    </p>
                                </div>
                            )}

                            {/* Guess Button */}
                            {guessedLocation && !showResult && (
                                <div className="absolute bottom-4 left-4 right-4">
                                    <button
                                        onClick={submitGuess}
                                        className="w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200 shadow-lg"
                                    >
                                        Submit Guess
                                    </button>
                                </div>
                            )}

                            {/* Result Panel */}
                            {showResult && (
                                <div className="absolute bottom-4 left-4 right-4 bg-white rounded-lg shadow-lg p-4">
                                    <div className="text-center mb-4">
                                        <h3 className="text-lg font-bold text-gray-800">Round {currentRound} Result</h3>
                                        <p className="text-2xl font-bold text-green-600">
                                            +{calculateScore(distance).toLocaleString()} points
                                        </p>
                                        <p className="text-sm text-gray-600">
                                            Distance: {Math.round(distance).toLocaleString()} km
                                        </p>
                                        <p className="text-sm text-gray-700 mt-2">
                                            <strong>Correct location:</strong> {currentLocation?.name}
                                        </p>
                                    </div>

                                    <button
                                        onClick={nextRound}
                                        className="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200"
                                    >
                                        {currentRound < totalRounds ? 'Next Round' : 'View Results'}
                                    </button>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<GeoGuessrGame />, document.getElementById('root'));
    </script>
    <script>(function () { function c() { var b = a.contentDocument || a.contentWindow.document; if (b) { var d = b.createElement('script'); d.innerHTML = "window.__CF$cv$params={r:'964798d7118b130b',t:'MTc1MzQwMzkzMy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);"; b.getElementsByTagName('head')[0].appendChild(d) } } if (document.body) { var a = document.createElement('iframe'); a.height = 1; a.width = 1; a.style.position = 'absolute'; a.style.top = 0; a.style.left = 0; a.style.border = 'none'; a.style.visibility = 'hidden'; document.body.appendChild(a); if ('loading' !== document.readyState) c(); else if (window.addEventListener) document.addEventListener('DOMContentLoaded', c); else { var e = document.onreadystatechange || function () { }; document.onreadystatechange = function (b) { e(b); 'loading' !== document.readyState && (document.onreadystatechange = e, c()) } } } })();</script>
</body>

</html>
